<!DOCTYPE html>
<html lang="en">
  <head>
    <meta property="og:title" content="<%= blog.title %>" />
    <meta
      property="og:description"
      content="Read this blog on <%= blog.title %>"
    />

    <meta
      property="og:image"
      content="https://ac2756e7c8e0.ngrok-free.app/<%= blog.coverImageUrl %>"
    />

    <meta
      property="og:url"
      content="https://ac2756e7c8e0.ngrok-free.app/blog/<%= blog._id %>"
    />
    <meta property="og:type" content="article" />

    <!-- Optional for better preview -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="<%= blog.title %>" />
    <meta
      name="twitter:description"
      content="Read this blog on <%= blog.title %>"
    />
    <meta name="twitter:image" content="<%= blog.coverImageUrl %>" />

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      body {
        background-color: #f8f9fa;
        font-family: "Segoe UI", Arial, sans-serif;
      }
      .news-header {
        background: #343a40;
        color: #fff;
        padding: 40px 0 20px 0;
        text-align: center;
        margin-bottom: 30px;
      }
      .news-header h1 {
        font-size: 2.8rem;
        margin-bottom: 10px;
        font-weight: 700;
      }
      .news-header p {
        font-size: 1.2rem;
        color: #ced4da;
      }
      .cardu {
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        border-radius: 8px;
        width: 100%;
      }
      .card:hover {
        transform: translateY(-5px) scale(1.02);
      }
      .card-img-top {
        border-top-left-radius: 8px;
        border-top-right-radius: 8px;
      }
      .card-title {
        font-size: 1.3rem;
        font-weight: 600;
      }
      .card-text {
        color: #495057;
        font-size: 1rem;
        margin-bottom: 15px;
      }
      .btn-primary {
        background-color: #007bff;
        border: none;
        font-weight: 500;
        padding: 8px 18px;
        border-radius: 4px;
      }
      .btn-primary:hover {
        background-color: #0056b3;
      }
   @media (max-width: 768px) {
  table {
    width: 100% !important; /* mobile view ke liye */
  }
}

    </style>
  </head>
  <body>
    <style>
      .card-text {
        display: block;
        white-space: pre-line;
        word-break: break-word;
      }
      .card-body {
        width: 100%;
      }
    </style>
    </head>

    <%- include('partial/head.ejs') %>
    

    <%- include('partial/navbar.ejs') %>

    <div class="container mt-4">
      <div class="row">
        <div class="card mb-4">
          <img
            src="<%= blog.coverImageUrl %>"
            class="card-img-top"
            width="400px"
            alt="<%= blog.title %>"
          />
          <div class="card-body">
            <h5 class="card-title"><%- blog.title %></h5>
            <div class="blog-content"><%- blog.content %> </div>
          </div>
        </div>
      </div>
    </div>
 <% if(locals.user){ %>
   <%- include('partial/addComments.ejs', { blog: blog }) %>
   <% }
        else { %>
          <div>first login to comment</div>
          <% }  %>
    <%- include('partial/showComments.ejs', {comments:comments}) %>
 <!--<%= comments %> -->
    <%- include('partial/script.ejs') %>
     <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script
      async
      src="https://platform.twitter.com/widgets.js"
      charset="utf-8"
    ></script>

    <script>
    
      function convertTwitterLinksToEmbeds() {
        const contents = document.querySelectorAll(".blog-content");

        contents.forEach((content) => {
          // STEP 1: Plain text Twitter links => <a> tag में बदलना (optional safety)
          const rawHTML = content.innerHTML;
          const updatedHTML = rawHTML.replace(
            /(https:\/\/twitter\.com\/[^\s<]+)/g,
            '<a href="$1">$1</a>'
          );
          content.innerHTML = updatedHTML;

          // STEP 2: <a> => <blockquote> embed
          const links = content.querySelectorAll("a[href*='twitter.com']");

          links.forEach((link) => {
            const href = link.href;
            if (href.includes("/status/")) {
              const blockquote = document.createElement("blockquote");
              blockquote.className = "twitter-tweet";
              const a = document.createElement("a");
              a.href = href;
              blockquote.appendChild(a);
              link.replaceWith(blockquote);
            }
          });
        });

        // STEP 3: Twitter widget re-load
        if (
          window.twttr &&
          window.twttr.widgets &&
          typeof window.twttr.widgets.load === "function"
        ) {
          window.twttr.widgets.load();
        }
      }

      // Run when all content and scripts are fully loaded
      window.addEventListener("load", convertTwitterLinksToEmbeds);
    </script>

    <script>
  document.addEventListener("DOMContentLoaded", function () {
    const videos = document.querySelectorAll("video");

    videos.forEach(video => {
      const src = video.getAttribute("src");
      
      // Agar video ke andar <source> nahi hai, to inject karo
      if (src && video.querySelector("source") === null) {
        const source = document.createElement("source");
        source.setAttribute("src", src);
        source.setAttribute("type", "video/mp4");
        video.removeAttribute("src"); // src ko upar se hatao
        video.appendChild(source);
      }

      // Agar controls missing hai to lagao
      if (!video.hasAttribute("controls")) {
        video.setAttribute("controls", "controls");
      }
    });
  });
</script>





  </body>
</html>
